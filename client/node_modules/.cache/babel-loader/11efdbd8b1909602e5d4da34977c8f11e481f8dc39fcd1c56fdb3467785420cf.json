{"ast":null,"code":"var _jsxFileName = \"D:\\\\nkurs\\\\client\\\\src\\\\pages\\\\ProductPage.js\",\n  _s = $RefreshSig$();\n// pages/ProductPage.js\nimport React, { useState, useEffect, useContext } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport { fetchOneProduct } from '../http/productAPI';\nimport { addToFavorite, removeFromFavorite, checkIsFavorite, getUserFavorites } from '../http/favoriteAPI';\nimport { Context } from '../index';\nimport { observer } from 'mobx-react-lite';\nimport '../css/pages/ProductPage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProductPage = _s(observer(_c = _s(() => {\n  _s();\n  const [product, setProduct] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [isFavorite, setIsFavorite] = useState(false);\n  const [favoriteId, setFavoriteId] = useState(null);\n  const {\n    id\n  } = useParams();\n  const history = useHistory();\n  const {\n    user\n  } = useContext(Context);\n  useEffect(() => {\n    const getProduct = async () => {\n      try {\n        setLoading(true);\n        const productData = await fetchOneProduct(id);\n        setProduct(productData);\n\n        // Проверяем, есть ли товар в избранном\n        if (user.isAuth) {\n          const favorites = await getUserFavorites(user.user.id);\n          const favoriteItem = favorites.find(fav => fav.product_id === productData.id);\n          if (favoriteItem) {\n            setIsFavorite(true);\n            setFavoriteId(favoriteItem.id);\n          }\n        }\n      } catch (e) {\n        setError('Ошибка при загрузке товара');\n        console.error('Error fetching product:', e);\n      } finally {\n        setLoading(false);\n      }\n    };\n    getProduct();\n  }, [id, user.isAuth, user.user.id]);\n  const handleFavoriteToggle = async () => {\n    if (!user.isAuth) {\n      alert('Для добавления в избранное необходимо авторизоваться');\n      return;\n    }\n    try {\n      if (isFavorite) {\n        await removeFromFavorite(favoriteId);\n        setIsFavorite(false);\n        setFavoriteId(null);\n      } else {\n        const favorite = await addToFavorite(user.user.id, product.id);\n        setIsFavorite(true);\n        setFavoriteId(favorite.id);\n      }\n    } catch (error) {\n      console.error('Error toggling favorite:', error);\n      alert('Ошибка при изменении избранного');\n    }\n  };\n\n  // ... остальной код без изменений до return ...\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"product-page-container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"back-button\",\n        onClick: () => history.goBack(),\n        children: \"\\u2190 \\u041D\\u0430\\u0437\\u0430\\u0434\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-image-section\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-image-card\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: process.env.REACT_APP_API_URL + product.img,\n              alt: product.name,\n              className: \"product-image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `favorite-button ${isFavorite ? 'favorite-active' : ''}`,\n              onClick: handleFavoriteToggle,\n              title: isFavorite ? 'Удалить из избранного' : 'Добавить в избранное',\n              children: \"\\u2665\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-info-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-header\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"product-title\",\n              children: product.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `favorite-button-large ${isFavorite ? 'favorite-active' : ''}`,\n              onClick: handleFavoriteToggle,\n              children: isFavorite ? 'В избранном ♥' : 'В избранное ♡'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 99,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-price\",\n            children: [product.price, \" $\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 9\n  }, this);\n}, \"TM5aJ2MGmJ2AwhDMqKMzdPxoLdU=\", false, function () {\n  return [useParams, useHistory];\n})), \"TM5aJ2MGmJ2AwhDMqKMzdPxoLdU=\", false, function () {\n  return [useParams, useHistory];\n});\n_c2 = ProductPage;\nexport default ProductPage;\nvar _c, _c2;\n$RefreshReg$(_c, \"ProductPage$observer\");\n$RefreshReg$(_c2, \"ProductPage\");","map":{"version":3,"names":["React","useState","useEffect","useContext","useParams","useHistory","fetchOneProduct","addToFavorite","removeFromFavorite","checkIsFavorite","getUserFavorites","Context","observer","jsxDEV","_jsxDEV","ProductPage","_s","_c","product","setProduct","loading","setLoading","error","setError","isFavorite","setIsFavorite","favoriteId","setFavoriteId","id","history","user","getProduct","productData","isAuth","favorites","favoriteItem","find","fav","product_id","e","console","handleFavoriteToggle","alert","favorite","className","children","onClick","goBack","fileName","_jsxFileName","lineNumber","columnNumber","src","process","env","REACT_APP_API_URL","img","alt","name","title","price","_c2","$RefreshReg$"],"sources":["D:/nkurs/client/src/pages/ProductPage.js"],"sourcesContent":["// pages/ProductPage.js\r\nimport React, { useState, useEffect, useContext } from 'react';\r\nimport { useParams, useHistory } from 'react-router-dom';\r\nimport { fetchOneProduct } from '../http/productAPI';\r\nimport { addToFavorite, removeFromFavorite, checkIsFavorite, getUserFavorites } from '../http/favoriteAPI';\r\nimport { Context } from '../index';\r\nimport { observer } from 'mobx-react-lite';\r\nimport '../css/pages/ProductPage.css';\r\n\r\nconst ProductPage = observer(() => {\r\n    const [product, setProduct] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const [isFavorite, setIsFavorite] = useState(false);\r\n    const [favoriteId, setFavoriteId] = useState(null);\r\n    const { id } = useParams();\r\n    const history = useHistory();\r\n    const { user } = useContext(Context);\r\n\r\n    useEffect(() => {\r\n        const getProduct = async () => {\r\n            try {\r\n                setLoading(true);\r\n                const productData = await fetchOneProduct(id);\r\n                setProduct(productData);\r\n\r\n                // Проверяем, есть ли товар в избранном\r\n                if (user.isAuth) {\r\n                    const favorites = await getUserFavorites(user.user.id);\r\n                    const favoriteItem = favorites.find(fav => fav.product_id === productData.id);\r\n                    if (favoriteItem) {\r\n                        setIsFavorite(true);\r\n                        setFavoriteId(favoriteItem.id);\r\n                    }\r\n                }\r\n            } catch (e) {\r\n                setError('Ошибка при загрузке товара');\r\n                console.error('Error fetching product:', e);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        getProduct();\r\n    }, [id, user.isAuth, user.user.id]);\r\n\r\n    const handleFavoriteToggle = async () => {\r\n        if (!user.isAuth) {\r\n            alert('Для добавления в избранное необходимо авторизоваться');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            if (isFavorite) {\r\n                await removeFromFavorite(favoriteId);\r\n                setIsFavorite(false);\r\n                setFavoriteId(null);\r\n            } else {\r\n                const favorite = await addToFavorite(user.user.id, product.id);\r\n                setIsFavorite(true);\r\n                setFavoriteId(favorite.id);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error toggling favorite:', error);\r\n            alert('Ошибка при изменении избранного');\r\n        }\r\n    };\r\n\r\n    // ... остальной код без изменений до return ...\r\n\r\n    return (\r\n        <div className=\"product-page-container\">\r\n            <div className=\"container\">\r\n                <button className=\"back-button\" onClick={() => history.goBack()}>\r\n                    ← Назад\r\n                </button>\r\n                \r\n                <div className=\"product-content\">\r\n                    <div className=\"product-image-section\">\r\n                        <div className=\"product-image-card\">\r\n                            <img \r\n                                src={process.env.REACT_APP_API_URL + product.img}\r\n                                alt={product.name}\r\n                                className=\"product-image\"\r\n                            />\r\n                            <button \r\n                                className={`favorite-button ${isFavorite ? 'favorite-active' : ''}`}\r\n                                onClick={handleFavoriteToggle}\r\n                                title={isFavorite ? 'Удалить из избранного' : 'Добавить в избранное'}\r\n                            >\r\n                                ♥\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div className=\"product-info-card\">\r\n                        <div className=\"product-header\">\r\n                            <h1 className=\"product-title\">{product.name}</h1>\r\n                            <button \r\n                                className={`favorite-button-large ${isFavorite ? 'favorite-active' : ''}`}\r\n                                onClick={handleFavoriteToggle}\r\n                            >\r\n                                {isFavorite ? 'В избранном ♥' : 'В избранное ♡'}\r\n                            </button>\r\n                        </div>\r\n                        \r\n                        <div className=\"product-price\">{product.price} $</div>\r\n                        \r\n                        {/* ... остальная информация о товаре ... */}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default ProductPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}